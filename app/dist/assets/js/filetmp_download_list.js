function OnArxSuccess(e){console.log(e)}function OnArxError(e){console.log(e)}var app=angular.module("myApp",[]);app.config(["$locationProvider",function(e){e.html5Mode({enabled:!0,requireBase:!1})}]),app.controller("userCtrl",["$scope","$http","$location",function(e,t,a){function r(a,r,n){e.queryParams.start=e.start,e.queryParams.count=e.count,e.queryParams.keyword=e.keyword,t.get(requestHost+"File/tempfile_list",{params:e.queryParams}).then(function(t){0==t.data.length?o():Array.prototype.push.apply(e.filelist,t.data)},function(e){console.log(e)})}e.queryParams=angular.copy(a.search()),e.from_ipm=e.queryParams.ipm,delete e.queryParams.ipm,e.alert={},e.dataToggle="modal",e.filelist=[],e.start=0,e.count=20,e.keyword;var o=e.$watch("start",r);e.search=function(){o(),e.start=0,e.filelist=[],o=e.$watch("start",r)},e.download=function(e){var t=encodeURI(e.file_name),a=e.download_url,r=e.role_id,o=e.file_state;execAsync(JSON.stringify({functionName:"DownloadFile",functionParams:{args:{file_name:t,url:a,role_id:r,file_state:o}},invokeAsCommand:!1}),OnArxSuccess,OnArxError)},e.deleteData={},e.setDeleteFile=function(t,a){e.deleteData.index=t,e.deleteData.id=a.id,e.dataToggle=""},e.delete=function(){var a={subproject_id:parseInt(e.queryParams.subproject_id),openid:e.queryParams.login_id,fileid:e.deleteData.id};t.post(requestHost+"Deletefile/deletetempfile",a).then(function(t){t.data.success?(e.alert.title="操作成功",e.filelist.splice(e.deleteData.index,1),e.from_ipm&&execAsync(JSON.stringify({functionName:"AfterAuditFile",functionParams:{args:{state:t.data.state}},invokeAsCommand:!1}),OnArxSuccess,OnArxError)):e.alert.title="操作失败",e.alert.content=t.data.message,$("#alertModal").modal("show")},function(t){e.alert.title="操作失败",e.alert.content=t.toString(),$("#alertModal").modal("show")})}}]);